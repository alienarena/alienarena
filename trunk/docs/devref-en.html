<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="AsciiDoc 8.6.9">
<title>Alien Arena Developer Reference</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Alien Arena Developer Reference</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Copyright &#169; 2011 COR Entertainment, LLC.</p></div>
<div class="paragraph"><p>Last update: 2015-01.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_about_this_document">About this Document</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content"><em>This is an informal document and assumes general knowledge
of programming and specific knowledge of Alien Arena development.</em></td>
</tr></table>
</div>
<div class="paragraph"><p>This document is intended to be informal reference for Alien
Arena development.  Its reason for being is it organize
general information, notes, and details about development
tools, build procedures, packaging, etc. In 2010, the Windows
build was converted to use Microsoft Visual Studio 2010 and
the Unix/Linux version was converted to use GNU Autotools.
Also, some work was done on MinGW and Mac OS X/Darwin X11
builds. A big reason for creating this document was to organize
the important details about all that in one place.</p></div>
<div class="paragraph"><p>The source for this document uses AsciiDoc.  Briefly, AsciiDoc
is a frontend for a variety of XSL document programs and runs on
Linux.  Linux distributions have it in their package managers.
Running it on Windows apparently requires using Cygwin,
unfortunately.  In some ways, it is "DocBook-for-Dummies"
and is relatively easy to edit.</p></div>
<div class="paragraph"><p>The home page for AsciiDoc is <a href="http://www.methods.co.nz/asciidoc/">http://www.methods.co.nz/asciidoc/</a>.</p></div>
<div class="paragraph"><p>The SourceForge repository is <a href="http://sourceforge.net/projects/asciidoc/">http://sourceforge.net/projects/asciidoc/</a>.</p></div>
<div class="paragraph"><p>In the <em>alienarena/docs/docsrc</em> directory this is the command used to generate output.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ asciidoc -b html5 -a toc2  devref-en.asciidoc</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_subversion_repository">Subversion Repository</h2>
<div class="sectionbody">
<div class="paragraph"><p>Alien Arena resources are stored in a Subversion (SVN)
repository at <a href="http://icculus.org">http://icculus.org</a>.  To browse the repository,
go to <a href="http://svn.icculus.org/alienarena/trunk">http://svn.icculus.org/alienarena/trunk</a>.  Use a Subversion
client program for downloading.  Read access to the repository
is not restricted.  Irritant administers commit access.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">The SVN versions of the <em>.sln</em> and <em>.vcxproj</em> files are
official. Do not commit these without clearance from Irritant.
Doing so could cause confusion and consternation.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_visual_c_2010_build">Visual C++ 2010 Build</h2>
<div class="sectionbody">
<div class="paragraph"><p><strong>Steps for building Release version with Visual C:</strong></p></div>
<div class="ulist"><ul>
<li>
<p>
Install TortoiseSVN.
</p>
</li>
<li>
<p>
Checkout Alien Arena from SVN.
</p>
</li>
<li>
<p>
Install and register Microsoft Visual C++ Express 2010.
</p>
</li>
<li>
<p>
Install the OpenAL SDK.
</p>
</li>
<li>
<p>
Install the libraries from the <em>.zip</em> files.
</p>
</li>
<li>
<p>
Install the libcurl patch.
</p>
</li>
<li>
<p>
Run <em>premake</em> to generate <em>config.h</em> for libode.
</p>
</li>
<li>
<p>
Open the <em>.sln</em> file in Visual Studio.
</p>
</li>
<li>
<p>
Select the Release build and run it.
</p>
</li>
<li>
<p>
Copy <em>VS2010\bin\Release\alienarena.exe</em> to the top directory.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">For the libode <em>config.h</em> (and maybe some other files), an
alternative is to get a copy from someone who has a working
installation.</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="_visual_c_2013_express_build">Visual C++ 2013 Express Build</h3>
<div class="paragraph"><p>As of 2014-11, this is known to work, but is not in the SVN
repository. The plan is to convert to VC++ 2013 in conjunction with
the SDL2 port (if that is successful). In conjunction with that, other
(non-SDL2) libraries should be updated.</p></div>
</div>
<div class="sect2">
<h3 id="_windows_subversion_client">Windows Subversion Client</h3>
<div class="paragraph"><p>Install TortoiseSVN, the free Subversion client from Tigris.
The website is <a href="http://tortoisesvn.net/">http://tortoisesvn.net/</a></p></div>
<div class="paragraph"><p>To download Alien Arena from the SVN Repository:</p></div>
<div class="ulist"><ul>
<li>
<p>
In Windows Explorer, go to the <em>Computer &#8594; C: folder</em>.
</p>
</li>
<li>
<p>
Right click in the window and select <em>SVN Checkout</em> in the context menu.
</p>
</li>
<li>
<p>
For the <em>URL of repository</em>, enter: <em>svn://icculus.org/alienarena/trunk</em>.
</p>
</li>
<li>
<p>
For the <em>Checkout directory</em>, enter: <em>C:\alienarena_w32</em>.
</p>
</li>
<li>
<p>
Leave the <em>Checkout Depth</em> at <em>Fully Recursive</em>, <em>Omit Externals</em> unchecked, and <em>Revision</em> at <em>Head Revision</em>.
</p>
</li>
<li>
<p>
Click <em>OK</em>, and let TortoiseSVN do its thing.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_microsoft_visual_c_2010_express">Microsoft Visual C++ 2010 Express</h3>
<div class="paragraph"><p>Microsoft Visual C++ 2010 Express is part of Microsoft Visual
Studio 2010 and is provided free of charge. Registration is
required. Download Visual C++ 2010 Express from the Microsoft
website (<a href="http://www.microsoft.com/">http://www.microsoft.com/</a>) and install it using the
default setups.</p></div>
<div class="paragraph"><p>Running programs compiled with VC++ 2010 requires the
redistributable dll, <em>msvcr100.dll</em>.  Some systems may not
have it installed; a copy is provided in SVN.</p></div>
</div>
<div class="sect2">
<h3 id="_libraries">Libraries</h3>
<div class="paragraph"><p>Extract the libraries in <em>lib_zipfiles</em> to <em>VS2010\libsrc</em>.</p></div>
<div class="paragraph"><p><strong>Patch for curl-7.20.1.</strong></p></div>
<div class="paragraph"><p>Unzip <em>libcurl_patch.zip</em> and replace
<em>curl-7.20.1/lib/setup_once.h</em>.  The original file, renamed
<em>setup_once_unpatched.h</em>, is included in the <em>.zip</em> for
reference.</p></div>
<div class="paragraph"><p><strong>Using premake for ODE config</strong></p></div>
<div class="paragraph"><p>A version of premake that supports VC++ 2010 is available at
<a href="http://industriousone.com/premake">http://industriousone.com/premake</a>. Look there and on the ODE website
for clues.</p></div>
<div class="paragraph"><p><strong>Some commentary on libraries</strong></p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">(2014-11) It is likely that with VC++ 2013 we will include
source subdirectories or pre-built versions for the 3rd party
libraries.</td>
</tr></table>
</div>
<div class="paragraph"><p>There is a rationale for keeping the libraries in the original
<em>.zip</em> archives in SVN, rather than extracting them into
SVN. For one thing, they are large and it would add a lot of
clutter to the repository. Also, the build is setup to allow
for multiple co-existing versions when libraries are updated.
It would be good to be able to bring in a new version&#8217;s <em>.zip</em>
into SVN and get it working before making the switch in the
official build.</p></div>
<div class="paragraph"><p>All the libraries supply build procedures for a variety of
environments. But, most did not have VC10 builds at the time
they were setup. The solution was to create projects in Visual
Studio for each of them. This has advantages, but is more
complicated than just using a supplied build. It does take
some work to get the build details correct and consistent.</p></div>
</div>
<div class="sect2">
<h3 id="_openal_1_1_sdk">OpenAL 1.1 SDK</h3>
<div class="paragraph"><p>Download the OpenAL SDK from OpenAL.org:
<a href="http://www.openal.org/">http://www.openal.org/</a>. (Redirects to the CreativeLabs
site.) In the Download section, get the <em>OpenAL 1.1 Core
SDK</em>. Install it in the default location; the build
procedure is setup to look for it there.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">On an x86 system, for example an old XP box, you
will need to change the path to use "Program files (x86)"
instead of the default.</td>
</tr></table>
</div>
<div class="paragraph"><p>Run the <em>oalinst.exe</em> program to setup the OpenAL driver,
if you have not done that previously.</p></div>
<div class="paragraph"><p>The <em>oalinst.exe</em> program installs whatever is required for
OpenAL to use a particular systems sound hardware. It is
included in the Alien Arena Windows distribution and is in SVN.</p></div>
</div>
<div class="sect2">
<h3 id="_directory_tree">Directory Tree</h3>
<div class="paragraph"><p>Here are the directories and files related to the Windows build.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
alienarena_w32\
</dt>
<dd>
<div class="dlist"><dl>
<dt class="hdlist1">
alienarena_w32.sln
</dt>
<dd>
<p>
    Solution file. Mostly just a list of the Projects in VS2010\.
</p>
</dd>
<dt class="hdlist1">
alienarena_w32.props
</dt>
<dd>
<p>
    Project property file. Generated and editted with the
    Visual Studio <em>Property Manager</em>.  It is fairly easy, and
    sometimes more convenient, to manually edit it. Projects
    can inherit compiler options, etc.  from here; which makes
    it much easier to make changes that affect all projects.
</p>
</dd>
<dt class="hdlist1">
msvcr100.dll
</dt>
<dd>
<p>
    Redistributable for Visual C++ 2010.
</p>
</dd>
<dt class="hdlist1">
oalinst.exe
</dt>
<dd>
<p>
    OpenAL installer.
</p>
</dd>
<dt class="hdlist1">
vs2010\
</dt>
<dd>
<p>
    Build directory for Windows version of Alien Arena.
</p>
<div class="dlist"><dl>
<dt class="hdlist1">
Project Files
</dt>
<dd>
<p>
       Project files. Generated and editted with Visual Studio.
       Somewhat easy to manually edit.
</p>
<div class="ulist"><ul>
<li>
<p>
crx.vcxproj
</p>
</li>
<li>
<p>
game.vcxproj
</p>
</li>
<li>
<p>
freetype.vcxproj
</p>
</li>
<li>
<p>
libcurl.vcxproj
</p>
</li>
<li>
<p>
libjpeg.vcxproj
</p>
</li>
<li>
<p>
libode.vcxproj
</p>
</li>
<li>
<p>
libogg.vcxproj
</p>
</li>
<li>
<p>
libopcode.vcxproj
</p>
</li>
<li>
<p>
libvorbis.vcxproj
</p>
</li>
<li>
<p>
libvorbisfile.vcxproj
</p>
</li>
<li>
<p>
zlib.vcxproj
</p>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
bin\
</dt>
<dd>
<p>
        Target directory. The <em>alienarena.exe</em> executable is placed
        here. There are <em>RELEASE</em> and <em>DEBUG</em> subdirectories
        created by the build procedure.
</p>
</dd>
<dt class="hdlist1">
lib\
</dt>
<dd>
<p>
        Target directory. The game and other libraries
        are placed here. There are <em>RELEASE</em> and <em>DEBUG</em>
        subdirectories created by the build procedure.
</p>
</dd>
<dt class="hdlist1">
libsrc\
</dt>
<dd>
<p>
        Source directory for libraries.
</p>
</dd>
<dt class="hdlist1">
include\
</dt>
<dd>
<p>
        Header files. The build procedure copies header files
        from the <em>libsrc</em> subdirectories to these directories
        for most of the libraries.
</p>
<div class="ulist"><ul>
<li>
<p>
config.h&#8201;&#8212;&#8201;<em>config.h</em> for <em>alienarena.exe</em> and <em>game.lib</em>.
</p>
</li>
<li>
<p>
curl\
</p>
</li>
<li>
<p>
jpeg\
</p>
</li>
<li>
<p>
ode\
</p>
</li>
<li>
<p>
ogg\
</p>
</li>
<li>
<p>
vorbis\
</p>
</li>
<li>
<p>
freetype-config\
</p>
<div class="ulist"><ul>
<li>
<p>
ftconfig.h
</p>
</li>
<li>
<p>
ftheader.h
</p>
</li>
<li>
<p>
ftmodule.h
</p>
</li>
<li>
<p>
ftoption.h
</p>
</li>
<li>
<p>
ftstdlib.h
</p>
</li>
</ul></div>
</li>
</ul></div>
</dd>
</dl></div>
</dd>
</dl></div>
</dd>
</dl></div>
<div class="paragraph"><p>The build procedure populates the <em>include</em> directories for
the various libraries. Makes the build more complicated, but
should make it easier to work with a new library version in
parallel with a current one.</p></div>
</div>
<div class="sect2">
<h3 id="_the_config_h_file">The config.h file</h3>
<div class="paragraph"><p>The <em>config.h</em> file for <em>alienarena.exe</em> and <em>game.lib</em> is an artifact
from the Unix/Linux build. In Unix/Linux, <em>config.h</em> is generated
by the <em>configure</em> procedure. For Windows, it is manually editted.</p></div>
<div style="page-break-after:always"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unix_linux_build">Unix/Linux Build</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction">Introduction</h3>
<div class="paragraph"><p>Beginning in August of 2010 the Unix/Linux build for Alien Arena
was converted from a Makefile to Autotools.  There are two main
goals for the implementation: One, to improve support for the
various Linux distributions' package maintainence process.
The other, to improve portability and ease of installation
for users.</p></div>
<div class="paragraph"><p>It is important to recognize that the goal of GNU Autotools is NOT to
make the developer&#8217;s job easier.  From a coder&#8217;s viewpoint, it is not,
nor is it intended to be, the ideal software construction tool. The mere
mention of Autotools elicits groans from most developers.  There are
alternatives, but for open source software, none have developed to the
point of being generally adopted as standard. There are some who disagree
with that statement, but they are mistaken.</p></div>
<div class="paragraph"><p>For development purposes it is sometimes better to use a plain makefile.
See <em>Developer&#8217;s Not-Autotools Makefile</em> below.</p></div>
<div class="sect3">
<h4 id="_reading_list_for_autotools">Reading List for Autotools</h4>
<div class="paragraph"><p>(Suggestion: Start with the <em>Autotools Mythbuster</em>.)</p></div>
<div class="ulist"><ul>
<li>
<p>
John Calcote.
  <em>Autotools: A Practitioner&#8217;s Guild to GNU Autoconf, Automake, and LibTool.</em>
</p>
</li>
<li>
<p>
Diego E. "Flameeyes" Petteno.
  <em>Autotools Mythbuster</em>
  <a href="http://www.flameeyes.eu/autotools-mythbuster/">http://www.flameeyes.eu/autotools-mythbuster/</a>.
</p>
</li>
<li>
<p>
David MacKenzie, Ben Elliston, Akim Demaille.
  <em>Autoconf: Creating Automatic Configuration Scripts</em>
  For version 2.65, 4 November 2009.
</p>
</li>
<li>
<p>
David MacKenzie, Tom Tromey, Alexandre Duret-Lutz.
  <em>GNU Automake</em>.
  For version 1.11.1, 8 December 2009.
</p>
</li>
<li>
<p>
Richard M. Stallman, Roland McGrath, Paul D. Smith.
  <em>GNU Make: A Program for Directing Recompilation</em>.
  GNU make Version 3.81, April 2006.
</p>
</li>
<li>
<p>
Gordon Matzigkeit, Alexandre Oliva, Thomas Tanner, Gary V. Vaughan.
  <em>GNU Libtool</em>.
  For version 2.2.6, 1 August 2008.
</p>
</li>
<li>
<p>
Richard Stallman, et al.
  <em>GNU Coding Standards</em>.
  last updated June 10, 2008.
</p>
</li>
<li>
<p>
Edited by Rusty Russell, Daniel Quinlan, Christopher Yeoh.
  <em>Filesystem Hierarchy Standard</em>
  Filesystem Hierarchy Standard Group.
</p>
</li>
<li>
<p>
Gary V. Vaughan, Ben Elliston, Tom Tromey and Ian Lance Taylor.
  <em>GNU AutoConf, AutoMake, and LibTool</em>
  "The Goat Book", Version 1.5, February 2006.
  <a href="http://sourceware.org/autobook">http://sourceware.org/autobook</a>.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_build_and_installation_changes_for_7_66">Build and Installation Changes for 7.66+</h3>
<div class="paragraph"><p>These are changes for the future release following 7.66 that are in
the SVN repository.</p></div>
<div class="sect3">
<h4 id="_user_8217_s_data_directory">User&#8217;s Data Directory</h4>
<div class="paragraph"><p>The user-writeable data and configuration directory is, by
default, <em>$HOME/.local/share/cor-games</em>. The program honors the
<em>XDG_DATA_HOME</em> environment variable. See:</p></div>
<div class="paragraph"><p><a href="http://standards.freedesktop.org/basedir-spec/basedir-spec-0.6.html">http://standards.freedesktop.org/basedir-spec/basedir-spec-0.6.html</a></p></div>
<div class="paragraph"><p>For development testing, the user-writeable directory may be
temporarily changed by running like this:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ XDG_DATA_HOME=/someother/directory alienarena</pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_botinfo_directories">Botinfo Directories</h4>
<div class="paragraph"><p>The <em>botinfo</em> resource subdirectory is moved to the <em>data1</em>
directory. There are user-writeable <em>botinfo</em> directories in the game
subdirectories. So there is, potentially, an <em>arena/botinfo</em> and a
<em>tactical/botinfo</em> in <em>$XDG_DATA_HOME/cor-games</em>.</p></div>
<div class="paragraph"><p>The shared data installation directory is specified in the build by
defining a <em>COR_DATADIR</em> preprocessor symbol. The default is
<em>/usr/local/share/alienarena</em>.</p></div>
</div>
<div class="sect3">
<h4 id="_autotools_related_changes">Autotools-related Changes</h4>
<div class="ulist"><ul>
<li>
<p>
Capability of separate source and data distribution packages.
</p>
</li>
<li>
<p>
Silent rules are disabled by default.
</p>
</li>
<li>
<p>
unix_dist repository directory. Documents are different.
</p>
</li>
<li>
<p>
the alternate install is eliminated with a better method.
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="_program_changes_in_7_50">Program Changes in 7.50</h4>
<div class="paragraph"><p>(Included here for reference.)</p></div>
<div class="paragraph"><p>Previous versions had support for configurable <em>DATADIR</em> and <em>LIBDIR</em>
installation paths.  However, the implementation was not complete; due
largely to the file system organization inherited from the Quake
source.  The installation procedure now uses configure arguments for
determining installation paths.</p></div>
<div class="paragraph"><p>Linux distributions install the game in the <em>/usr</em> hierarchy in
conformance with Unix file system standards.  The <em>/usr</em> hierarchy
requires root privileges for writing, of course.  While the game
already had support for a user writeable directory, <em>.codered/</em>, in
the users home directory, it did not implement a place to write bot
information.  Therefore, support for a <em>botinfo</em> directory in the
user&#8217;s home directory was added.</p></div>
<div class="paragraph"><p>To simplify the installation and to avoid the complications of using a
shared library, the game module shared library, <em>game.so</em>, is now a
static library.  As a result, the <em>LIBDIR</em> installation variable is
eliminated.  Internally, the interface to the game module retains the
dynamic link structure. Thus, it is still possible, in theory, to have
a dynamic <em>game.so</em> that overrides the statically linked version. This
is not tested nor supported in version 7.50.</p></div>
<div class="paragraph"><p>Two new functions were added to the server/game interface for file
system access. The location of game data files depends on how the game
is installed. The code should not make assumptions about the base path
since it might be affected by "prefix" and "datadir" configuration
options. The game module will now determine all file paths using those
functions (eliminating problems where the code assumed the legacy
Quake style file system).  The additional functions make it possible
to place a <em>botinfo</em> directory, in user-writeable file space. The two
new functions supply the full filesystem path when given a relative
path.  The functions are <strong>FullPath()</strong> and <strong>FullWritePath()</strong>.  They are
declared in <em>game/game.h</em> and <em>qcommon/qcommon.h</em>.  They are defined
in <em>qcommon/files.c</em>.</p></div>
<div class="paragraph"><p>The name of the stand-alone dedicated server was changed from <em>crded</em>
to <em>crx-ded</em>. The purpose was to make it simple to change the name of
the executable files using the standard built-in configure
option.</p></div>
</div>
<div class="sect3">
<h4 id="_program_changes_in_7_60">Program Changes in 7.60</h4>
<div class="paragraph"><p>(Included here for reference.)</p></div>
<div class="paragraph"><p>With the 7.60 release, the dedicated server name was updated
to <em>alienarena-ded</em>.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_subversion_repository_2">Subversion Repository</h3>
<div class="sect3">
<h4 id="_linux_subversion_client">Linux Subversion Client</h4>
<div class="paragraph"><p>Install the free Apache (formerly Tigris) Subversion client using your
package manager.  Or download it from the website at
<a href="http://subversion.apache.org/">http://subversion.apache.org/</a> .</p></div>
<div class="paragraph"><p>To download Alien Arena from the SVN Repository:</p></div>
<div class="ulist"><ul>
<li>
<p>
Create a <em>'PATH</em>' for installation somewhere in your home directory.
</p>
</li>
<li>
<p>
Run: <em>svn checkout svn://icculus.org/alienarena/trunk PATH</em>.
</p>
</li>
</ul></div>
<div class="paragraph"><p>For example:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ cd
$ mkdir alienarena
$ svn checkout svn://icculus.org/alienarena/trunk alienarena</pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="_maintainer_8217_s_guide">Maintainer&#8217;s Guide</h3>
<div class="sect3">
<h4 id="_autotools_source_files">Autotools Source Files</h4>
<div class="paragraph"><p>These are Autotools-related files that are manually edited:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
configure.ac
</dt>
<dd>
<p>
  source file for <em>autoconf</em>.
</p>
</dd>
<dt class="hdlist1">
Makefile.am
</dt>
<dd>
<p>
  top level source file for <em>automake</em>.
</p>
</dd>
<dt class="hdlist1">
source/Makefile.am
</dt>
<dd>
<p>
  <em>source</em> subdirectory source file for <em>automake</em>.
</p>
</dd>
<dt class="hdlist1">
data1/configure.ac
</dt>
<dd>
<p>
  source file for <em>autoconf</em> for generating separate data package.
</p>
</dd>
<dt class="hdlist1">
data1/Makefile.am
</dt>
<dd>
<p>
  <em>data1</em> top-or-second level source file for <em>automake</em>.
</p>
</dd>
<dt class="hdlist1">
data1/*/Makefile.am
</dt>
<dd>
<p>
  subdirectory <em>Makefiles</em> for <em>data1</em> subdirectories.
</p>
</dd>
</dl></div>
<div class="paragraph"><p>Some Autotools files are just copied without change:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
m4/*.m4
</dt>
<dd>
<p>
  m4 macros from the autoconf-archive.
</p>
</dd>
<dt class="hdlist1">
config/compile
</dt>
<dt class="hdlist1">
config/config.guess
</dt>
<dt class="hdlist1">
config/config.sub
</dt>
<dt class="hdlist1">
config/depcomp
</dt>
<dt class="hdlist1">
config/install-sh
</dt>
<dt class="hdlist1">
config/missing
</dt>
<dd>
<p>
  auxiliary shell scripts used by <em>configure</em> and <em>Makefiles</em>
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_autotools_generated_files">Autotools Generated Files</h4>
<div class="paragraph"><p>The Alien Arena Autotools build uses <strong>Maintainer Mode</strong>. The upside of
this is that the end user does <strong>not</strong> need the Autotools programs and can
run the well-known <em>./configure, make, sudo make install</em> procedure. The
downside is that if <em>configure</em> is run without <em>--enable-maintainer-mode</em>,
some of the generated files will not be updated.</p></div>
<div class="paragraph"><p>The <strong>Generated Files</strong> are:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
configure
</dt>
<dd>
<p>
  the user&#8217;s configure script.
</p>
</dd>
<dt class="hdlist1">
Makefile.in
</dt>
<dd>
<p>
  template for the user&#8217;s top directory Makefile.
</p>
</dd>
<dt class="hdlist1">
source/Makefile.in
</dt>
<dd>
<p>
  template for the user&#8217;s source subdirectory Makefile.
</p>
</dd>
<dt class="hdlist1">
config/config.h.in
</dt>
<dd>
<p>
  template for the user&#8217;s config.h.
</p>
</dd>
<dt class="hdlist1">
aclocal.m4
</dt>
<dd>
<p>
  all the .m4 macros used by <em>configure</em>. generated by <em>aclocal</em>.
</p>
</dd>
</dl></div>
<div class="paragraph"><p>The <em>Generated Files</em> need to be regenerated when any of following occur:</p></div>
<div class="ulist"><ul>
<li>
<p>
Source files (.c, .h, etc.) are added, removed or renamed.
</p>
</li>
<li>
<p>
System libraries are added or removed (in configure.ac, Makefile.am files).
</p>
</li>
<li>
<p>
Asset files (textures, models, etc.) are added, removed or renamed.
</p>
</li>
<li>
<p>
Autotools files (configure.ac, Makefile.am, etc.) are modified.
</p>
</li>
</ul></div>
<div class="paragraph"><p><strong>Note</strong>
There are other intermediate files generated by Autotools. Refer to Autotools
documentation.</p></div>
</div>
<div class="sect3">
<h4 id="_autotools_prerequisites">Autotools Prerequisites</h4>
<div class="paragraph"><p>The Autotools packages are:</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>autoconf</em>
</p>
</li>
<li>
<p>
<em>automake</em>,
</p>
</li>
<li>
<p>
<em>autoconf-archive</em>
</p>
</li>
</ul></div>
<div class="paragraph"><p>To avoid confusion, developers committing to the repository should all be
using the same versions of these packages.</p></div>
<div class="paragraph"><p>The <em>autoconf-archive</em> is an evolving set of macros maintained on the GNU
website. We use a few of these. The file names are normally prefixed with
<em>ax_</em> and the macros prefixed with <em>AX_</em>. Each file has a <em>serial</em> number
in a comment. Care should be take not to commit an earlier version of a
<em>.m4</em> file into the SVN <em>m4</em> subdirectory. If a file we use is updated in
the archive, update it in the repository.</p></div>
<div class="paragraph"><p>After adding new <em>AX_</em> macros to <em>configure.ac</em>, the <em>.m4</em> file needs to be
added to the <em>m4</em> subdirectory. This is done with the following command.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ aclocal -I m4 --force --install</pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_adding_removing_renaming_program_source_files">Adding, Removing, Renaming Program Source Files</h4>
<div class="paragraph"><p>Source files are modified in the <em>source/Makefile.am</em> file. Modify the
source in the applicable <em>*_SOURCE</em> lists. Header (<em>.h</em>) files must
be included, because the list is used to generate the tarball.</p></div>
<div class="paragraph"><p>Certain files may appear in several lists. For example, <em>'alienarena_SOURCES</em>,
<em>alienarena-ded_SOURCES</em> and <em>libgame_a_SOURCES</em> all have <em>qcommon/qfiles.h</em>.</p></div>
</div>
<div class="sect3">
<h4 id="_adding_removing_renaming_game_asset_files">Adding, Removing, Renaming Game Asset Files</h4>
<div class="paragraph"><p>There is a set of subdirectory <em>Makefile.am</em> files that contain lists
of game resources. These are invoked recursively during the <em>make
install</em> and <em>make distcheck</em> procedures. They contain only those
resources that are to be included in the distribution tarball.</p></div>
<div class="paragraph"><p>The downside is that these files needs to be kept up-to-date with
additions and deletions. The advantage is that the <em>install</em> program
handles the copying of game resources. For <em>make uninstall</em> it handles
deletion of what <em>make install</em> installed.</p></div>
<div class="paragraph"><p>To make modifications, find the appropriate <em>Makefile.am</em> and add,
delete or modify the file entry. Makefile syntax requires that there
be no trailing spaces after the <em>\</em>. Each entry should be preceeded by
one TAB character.  The files are listed in (mostly) alphabetical
order.</p></div>
<div class="paragraph"><p>Formerly, the game resource list was a monolithic file
(<em>game_data.am</em>).  With version 7.60 the number of resources exceeded
the command line length limit.</p></div>
<div class="sect4">
<h5 id="_is_this_a_pita_or_what">Is this a PITA, or what?</h5>
<div class="paragraph"><p>Yes, it is. It would be nice not to have to reconfigure when game
assets are added or deleted. It would be fairly straightforward to
implement a simpler method, if the SVN repository contained only those
resources that were part of the release package. Since that is not an
option, any other method would need to have some kind of list of
"official" resources. Changing that list might be simpler than
editting Makefiles and reconfiguring, but not that much simpler.</p></div>
</div>
</div>
<div class="sect3">
<h4 id="_adding_or_removing_system_libraries">Adding or Removing System Libraries</h4>
<div class="paragraph"><p>The details of changing the system library settings are way beyond
the scope of this document. Some knowledge of autoconf and automake
is required.</p></div>
<div class="paragraph"><p>For common system libraries, there <strong>may</strong> be a helpful <em>.m4</em> macro available.
These may be part of autoconf (AC_*), or they may be extensions from
the Autoconf Archive (AX_*).</p></div>
</div>
<div class="sect3">
<h4 id="_procedures">Procedures</h4>
<div class="paragraph"><p>There are various clean options, besides the usual, that remove more than
object files. Some useful ones are:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
maintainer-clean
</dt>
<dd>
<p>
  removes most generated files. run <em>autoreconf</em> to rebuild them.
</p>
</dd>
<dt class="hdlist1">
distclean
</dt>
<dd>
<p>
  removes files generated by <em>configure</em>.
</p>
</dd>
</dl></div>
<div class="paragraph"><p>Following any changes changes to configure.ac files or Makefile.am
files, or after <em>make maintainer-clean</em> do:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ autoreconf --verbose --force --install
$ ./configure --enable-maintainer-mode &lt;other options&gt;
$ make
$ sudo make install</pre>
</div></div>
<div class="paragraph"><p>The <em>--force</em> and <em>--install</em> options to <em>autoreconf</em> are not usually
needed. Run <em>autoreconf --help</em> for descriptions. The <em>--install</em> option
copies files to <em>m4/</em> and <em>config/</em>.</p></div>
<div class="paragraph"><p>For source code only updates, all that is needed are:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ make clean (usually optional)
$ make
$ sudo make install-exec</pre>
</div></div>
<div class="paragraph"><p>After a <em>make distclean</em>, do:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ ./configure --enable-maintainer-mode &lt;other options&gt;
$ make
$ sudo make install (or install-exec)</pre>
</div></div>
<div class="paragraph"><p>When game assets are modified it is usually a good idea to remove the
existing assets installed by the last <em>make install</em>. Do this with:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ sudo make uninstall</pre>
</div></div>
<div class="paragraph"><p>If this is done after doing an SVN update and regenerating the
installation Makefiles, it may not delete old files. So, it is a good
idea to check that the installation directories are cleared. One way
to do that:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ find /usr/local/share/alienarena -type f</pre>
</div></div>
<div class="paragraph"><p>There are variations for the <em>configure</em> and <em>make install</em> commands, of course.
See below for <em>configure</em> options and compiler options.</p></div>
<div class="paragraph"><p>The <em>make</em> command runs faster with a multicore CPU if you add the
<em>-jN</em> option where <em>N</em> is the number of cores plus one.</p></div>
<div class="paragraph"><p>Run some tests and, if all this goes well, commit the changed files to the
repository. The <em>svn status</em> command will show which files were modified.</p></div>
<div class="paragraph"><p>If you want to commit only a subset of the changed files, the SVN
<em>changelist</em> command is your friend.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_packager_8217_s_guide">Packager&#8217;s Guide</h3>
<div class="sect3">
<h4 id="_verify_autotools_versions">Verify Autotools Versions</h4>
<div class="paragraph"><p>Verify that your versions of <em>autoconf</em>, <em>automake</em>, and
<em>autoconf-archive</em> are current.</p></div>
<div class="paragraph"><p>The 7.66 release uses <em>autoconf 2.69</em> and <em>automake 1.14</em>. If more than
one dev is committing autotool related changes to SVN, it will be less
confusing if all are using the same versions.</p></div>
<div class="paragraph"><p>As of 2015-01, the "7.66.1" SVN development version is using <em>automake
1.13.4</em> (because that&#8217;s my distro&#8217;s default, that&#8217;s why.).</p></div>
</div>
<div class="sect3">
<h4 id="_verify_alien_arena_version">Verify Alien Arena Version</h4>
<div class="paragraph"><p>Verify that the version number in <em>configure.ac</em> is correct.</p></div>
</div>
<div class="sect3">
<h4 id="_verify_autotools_files">Verify Autotools Files</h4>
<div class="paragraph"><p>See the <em>Maintainer&#8217;s Guide</em> above. Verify that all Autotools-related
files are up-to-date.</p></div>
</div>
<div class="sect3">
<h4 id="_export_from_subversion_repository">Export from Subversion Repository</h4>
<div class="paragraph"><p>Export from the SVN trunk to a directory for the distribution
build.</p></div>
<div class="paragraph"><p>Verify that the files in <em>config/</em> and <em>m4/</em> subdirectories
are current.  One way to do this is to rename the <em>config/</em>
and <em>m4/</em> directories and then run:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ aclocal --force --install -I m4
$ autoreconf --force --install</pre>
</div></div>
<div class="paragraph"><p>Compare the files in the new <em>config/</em> and <em>m4/</em> with the
previous ones.  If they match, proceed. If not, then the files
in SVN need to be updated.  The cleanest thing to do would be
to update SVN and do a new export.</p></div>
<div class="paragraph"><p>As of 2015-01, the only files in m4/ are manually copied. But, in the
future it may contain <em>libtool</em> files that are updated by the commands
above.</p></div>
</div>
<div class="sect3">
<h4 id="_generate_the_distribution_archive">Generate the Distribution Archive</h4>
<div class="paragraph"><p>Run this command to build and verify the distribution package:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ make distcheck</pre>
</div></div>
<div class="paragraph"><p>If this succeeds, the alienarena-&lt;version&gt;.tar.gz has been created.</p></div>
</div>
<div class="sect3">
<h4 id="_test_the_distribution_package">Test the Distribution Package</h4>
<div class="paragraph"><p>In a test directory, extract the distribution archive.
Run the configure, make, make install sequence.  Use the
--prefix configure option to install into a test directory.</p></div>
<div class="paragraph"><p>To test the dedicated server only build, create a subdirectory
and build with an alternative test directory.  In the
subdirectory, <em>configure</em> is invoked with <em>../configure</em>.</p></div>
</div>
<div class="sect3">
<h4 id="_example">Example</h4>
<div class="paragraph"><p>An example for testing distribution package generation:</p></div>
<div class="ulist"><ul>
<li>
<p>
Assuming a development directory in <em>$HOME/alienarena.</em>
</p>
</li>
<li>
<p>
Generate tarball in $HOME/test_dist
</p>
</li>
<li>
<p>
Test build and install in $HOME/test_build
</p>
</li>
<li>
<p>
Installing in <em>/usr/local</em>.
</p>
</li>
</ul></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ cd $HOME/alienarena
$ svn export . $HOME/test_dist
$ cd $HOME/test_dist
$ ./configure
$ make distcheck
$ cd ..
$ mkdir test_build
$ cd test_build
$ mv ../test_dist/alienarena-7.66.1.tar.gz .
$ tar -xzf alienarena-7.66.1.tar.gz
$ cd alienarena-7.66.1
$ ./configure
$ make
$ sudo make install
$ cd ~
$ alienarena</pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_generate_separate_source_and_data_archives">Generate Separate Source and Data Archives</h4>
<div class="paragraph"><p>For release, separate source and data archives should be generated in
addition to the monolithic archive. This is primarily for the
convenience of distro packagers. Distros normally use separate source
and data packages; possibly, because the licenses for the source and
data are different.</p></div>
<div class="paragraph"><p>For the source-only package:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ ./configure --without-data
$ make distcheck
$ mv alienarena-7.66.1.tar.gz alienarena-src-7.66.1.tar.gz</pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">This will overwrite a previously generated monolithic
tarball. Recommended: Do the separate source tarball and rename it
first.</td>
</tr></table>
</div>
<div class="paragraph"><p>For the data1-only package, in the data1 directory:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>$ ./configure
$ make distcheck
$ mv alienarena-7.66.1.tar.gz ../alienarena-data-7.66.1.tar.gz</pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_bash_script_for_distribution_tarball_generation">BASH script for distribution tarball generation</h4>
<div class="paragraph"><p>This script uses several SVN <em>export</em> commands to retrieve the
subset of files needed for the release tarball. It then invokes
<em>make distcheck</em> to build the tarballs. Run the script in a
RELEASE directory.</p></div>
<div class="paragraph"><p>The following commands generate the checksums and then run a <em>diff</em> to
check for possibly missing files. This compares the repository
directories with what is in the tarball. Since, not all repository
files are distributed, this requires knowing what files are not
supposed to be in the tarball. (But, we are not too picky about
putting "extra" stuff in the tarball.)</p></div>
<div class="paragraph"><p>In the RELEASE directory:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>$ mv alienarena/alienarena-&lt;version&gt;.tar.gz .
$ md5sum alienarena-&lt;version&gt;.tar.gz &gt;md5
$ sha1sum alienarena-&lt;version&gt;.tar.gz &gt;sha1
$ tar -xzf alienarena-&lt;version&gt;.tar.gz
$ diff -r -q alienarena alienarena-&lt;version&gt;</pre>
</div></div>
<div class="paragraph"><p>The Script:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>#!/bin/bash
#
# Alien Arena release tarball generation
#
# --- top level ---
svn export --ignore-externals --non-recursive \
 svn://icculus.org/alienarena/trunk alienarena
###
# --- config/ ---
svn export --ignore-externals \
 svn://icculus.org/alienarena/trunk/config alienarena/config
###
# --- m4/ ---
svn export --ignore-externals \
 svn://icculus.org/alienarena/trunk/m4 alienarena/m4
###
# --- source/ ---
svn export --ignore-externals \
 svn://icculus.org/alienarena/trunk/source alienarena/source
###
# --- unix_dist/ ---
svn export --ignore-externals \
 svn://icculus.org/alienarena/trunk/unix_dist alienarena/unix_dist
###
# --- arena/ ---
svn export --ignore-externals \
 svn://icculus.org/alienarena/trunk/arena alienarena/arena
###
# --- tactical/ ---
svn export --ignore-externals \
 svn://icculus.org/alienarena/trunk/tactical alienarena/tactical
###
# --- data1/ ---
svn export --ignore-externals \
  svn://icculus.org/alienarena/trunk/data1 alienarena/data1
###
# ---
cd alienarena
###
# --- source-only tarball construction ---
./configure --without-data1pkg
make distcheck
mv alienarena-&lt;version&gt;.tar.gz alienarena-src-&lt;version&gt;.tar.gz
make distclean
###
# --- data-only tarball construction ---
cd data1
./configure
make distcheck
mv alienarena-&lt;version&gt;.tar.gz alienarena-data-&lt;version&gt;.tar.gz
make distclean
cd ..
###
# --- combined source and data tarball construction ---
./configure
make distcheck</pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="_configure_options">Configure options</h3>
<div class="paragraph"><p>Run <span class="monospaced">./configure --help</span> to see all <em>configure</em> options. The ones
described here are <em>configure</em> options added for Alien Arena.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
--disable-client
</dt>
<dd>
<p>
  build dedicated server only, not the client (default:no)
</p>
</dd>
<dt class="hdlist1">
--disable-build-status
</dt>
<dd>
<p>
  hide  the  status message at the end of the configuration
  script (default:no)
</p>
</dd>
<dt class="hdlist1">
--with(out)-xf86vm
</dt>
<dd>
<p>
  include XF86 VidMode support (default: check)
  Note: Needed to support full-screen mode.
  Note: If <em>with</em> is specified, then the library is required.
</p>
</dd>
<dt class="hdlist1">
--with(out)-xf86dga
</dt>
<dd>
<p>
  include XF86 DGA support (default: without)
  Note: default is changed from <em>check</em> in version 7.60
  Note: DGA appears to only used for mouse pointer input and
  is optional. It is disabled by default, or when the cvar,
  <em>in_dgamouse</em>, is set to 0.
  Note: If <em>with</em> is specified, then the library is required.
</p>
</dd>
<dt class="hdlist1">
--with(out)-zlib
</dt>
<dd>
<p>
  include Zlib compress support (default: check)
  Note: If <em>with</em> is specified, then the library is required.
</p>
</dd>
<dt class="hdlist1">
--with-icondir=DIR
</dt>
<dd>
<p>
  icon install directory (default:DATADIR/icons)
</p>
</dd>
<dt class="hdlist1">
--with(out)-data1pkg
</dt>
<dd>
<p>
  include game resources from data1 directory (default: with)
  Note: used for creating separate source and data tarballs.
</p>
</dd>
<dt class="hdlist1">
--disable-assert
</dt>
<dd>
<p>
  supplied by AC_HEADER_ASSERT macro. defines NDEBUG in config.h
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_gcc_compiler_options">GCC Compiler Options</h3>
<div class="paragraph"><p>Linux distro&#8217;s use a variety of different gcc compile options. These
can give more error warnings; and in rare cases program errors.</p></div>
<div class="paragraph"><p>Also for users who compile from source, there are CPU dependendent
options that might give better performance. Might be good to document
some of these in the README.</p></div>
<div class="paragraph"><p>These are commonly used or have been seen in distro builds:</p></div>
<div class="paragraph"><p>(2015-01 suggestion: see wiki.gentoo.org/wiki/GCC_optimization)</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Wall
</dt>
<dt class="hdlist1">
Wextra
</dt>
<dd>
<p>
  With -Wextra many warnings are produced, especially for unused parameters
  and signed/unsigned comparisons. With just -Wall, a few unused variable
  warnings are produced, which are easily fixed. Some bogus uninitialized
  warnings are produced; it is possible, but annoying, to eliminate these.
</p>
</dd>
<dt class="hdlist1">
O2
</dt>
<dt class="hdlist1">
O3
</dt>
<dd>
<p>
  Optimization levels. O3 produces different warning messages, so should
  be tested before releases.
</p>
</dd>
<dt class="hdlist1">
pipe
</dt>
<dd>
<p>
  Use pipes, rather than temp files; speeds up compilation.
</p>
</dd>
<dt class="hdlist1">
m32
</dt>
<dt class="hdlist1">
m64
</dt>
<dd>
<p>
  Specify 32bit or 64bit build. Only needed when cross-compiling.
</p>
</dd>
<dt class="hdlist1">
march
</dt>
<dd>
<p>
  Set for specific architectures. Might give better performance than
  generic builds. For example, use <span class="monospaced">-march=native</span> for local builds.
  Use <span class="monospaced">-march=generic</span> when building release binaries; for Desura, for
  instance.
</p>
</dd>
<dt class="hdlist1">
FORTIFY_SOURCE
</dt>
<dd>
<p>
  <span class="monospaced">-Wp,D_FORTIFY_SOURCE=2</span> part of "stack smashing" protection
</p>
</dd>
<dt class="hdlist1">
fexceptions
</dt>
<dd>
<p>
  TBD.
</p>
</dd>
<dt class="hdlist1">
fstack-protector
</dt>
<dd>
<p>
  Part of "stack smashing" protection.
</p>
</dd>
<dt class="hdlist1">
param
</dt>
<dd>
<p>
  <span class="monospaced">--param=ssp-buffer-size=4</span>. Part of "stack smashing" detection.
</p>
</dd>
<dt class="hdlist1">
fasynchronous-unwind-tables
</dt>
<dd>
<p>
  From fedora. TBD.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_config_h">config.h</h3>
<div class="paragraph"><p>The config.h file is auto-generated for configurable builds (e.g
Linux).  It is manually edited for non-configurable builds
(e.g. Windows). The <em>configure.ac</em> file does generate Windows related
definitions in <em>config.h</em> so it can be used as a basis for the Windows
<em>config.h</em>.</p></div>
<div class="paragraph"><p>Rather than use symbols built into the compiler these symbols (and
some others related to targets) are defined: <em>WIN32_VARIANT</em> and
<em>UNIX_VARIANT</em>.  This should make it easier to keep system dependent
variations organized. It is a good idea, of course, to minimize system
dependent conditional compilation in the common code.</p></div>
</div>
<div class="sect2">
<h3 id="_open_dynamics_engine_ode_integration">Open Dynamics Engine (ODE) Integration</h3>
<div class="paragraph"><p>Formerly, we built and linked our own ODE static library. That is no
longer the case.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mingw_build">MinGW Build</h2>
<div class="sectionbody">
<div class="paragraph"><p>Experimentally, Alien Arena has been built using MinGW using the
Autotools build. Since there was no particular reason to maintain it,
the experimental MinGW support was removed from the Autotools build.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_mac_os_x_darwin_x11_build">Mac OS X / Darwin X11 Build</h2>
<div class="sectionbody">
<div class="paragraph"><p>The Autotools build has support for Mac OS X using the Darwin X11
environment. MacPorts (www.macports.org) has port maintained by
"ryandesign". It would be a good idea to consult with him before a
release to verify that the Autotools build is correct.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_developer_8217_s_not_autotools_makefile">Developer&#8217;s Not-Autotools Makefile</h2>
<div class="sectionbody">
<div class="paragraph"><p>(This is way out of date. Included here for reference.)</p></div>
<div class="paragraph"><p>In the <em>docs/</em> directory, the file, <em>dev-makefile</em>, is
a <em>Makefile</em> intended to support experimental builds. Its
primary purpose is to allow custom builds with additional
or different sources without having to hack the Autotools
build. Documentation on how to customize it is included within
the <em>dev-makefile</em> file.</p></div>
<div class="paragraph"><p>It is simpler to make a full copy of the trunk sources, but that
is not necessary. It takes some trickiness setting up <em>vpaths</em>
and customizing <em>-I</em> options, but it is possible to do an
alternate build with a small subset of sources in an alternate
source subdirectory.  Good for experimenting with optimizations.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_desura">Desura</h2>
<div class="sectionbody">
<div class="paragraph"><p>The information of Desura is in a separate document, devref-desura-en.html.
It is generated from a AsciiDoc source in docsrc/devref-desura-en.asciidoc.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_static_analysis">Static Analysis</h2>
<div class="sectionbody">
<div class="paragraph"><p>TODO:</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_phoronix_test_suite">Phoronix Test Suite</h2>
<div class="sectionbody">
<div class="paragraph"><p>Some initial experimentation with PTS has been done.  It has potential
for collecting information about performance on a variety of systems
and for regression testing.  The current (vers 7.65) benchmarking
support in the code needs work.  Briefly, 1) running timedemo
benchmarks is not worthwhile without knowing what code is covered. 2)
a benchmark mode is needed to simplify the configuration. Normally,
there should be no network activity, and sound should be
disabled. Possible, but inconvenient to do with .cfgs.  3) the
benchmark output should be more detailed.</p></div>
<div class="paragraph"><p>An opinion: It would be nice to be included in set of games Phoronix
uses to test hardware. But, there is not much point in that unless we
can bring something new to the table.</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr></div>
<div id="footer">
<div id="footer-text">
Last updated 2015-01-13 22:27:22 PST
</div>
</div>
</body>
</html>
